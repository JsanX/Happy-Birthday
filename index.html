<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Someone Special ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            height: 100vh;
            touch-action: manipulation;
             background: linear-gradient(135deg, #f340e4, #f3e8ff);
        }

        #app {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        #content {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .step {
            position: absolute;
            width: 100%;
            max-width: 800px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.509);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            pointer-events: none;
        }
        /* .step {
            text-align: left;
        }

        .step h1,
        .step h2,
        .step .emoji {
            text-align: center;
        } */

        .step p {
             text-align: left;
            line-height: 1.8;
        }
        /* .step p { */
            /* max-width: 600px; */
            /* margin: 0 auto 1.5em auto; keep it centered in the step container */
        /* } */

        .text-center-override {
            text-align: center;
        }

        .step.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        #step3 {
            position: relative;
            z-index: 1;
        }

        #step3::before {
            content: "";
            position: absolute;
            top: -40px;
            left: -40px;
            right: -40px;
            bottom: -40px;
            background: radial-gradient(circle, rgba(255,105,180,0.25), transparent 70%);
            filter: blur(60px);
            z-index: -1;
            animation: auraGlow 6s ease-in-out infinite alternate;
        }

        .step-scrollable {
            max-height: 80vh; /* fits most mobile screens */
            overflow-y: auto;
            padding-right: 10px; /* avoid scrollbar overlapping content */
            scroll-behavior: smooth; /* smooth scrolling */
        }

        /* Optional: style the scrollbar for Webkit browsers */
        .step-scrollable::-webkit-scrollbar {
            width: 6px;
        }

        .step-scrollable::-webkit-scrollbar-thumb {
            background: #ec4899;
            border-radius: 3px;
        }

        @keyframes auraGlow {
            0% {
                opacity: 0.6;
                transform: scale(1);
            }
            100% {
                opacity: 1;
                transform: scale(1.1);
            }
        }

        .btn {
            background: linear-gradient(135deg, #c934c9, #f07f92);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(236, 72, 153, 0.3);
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(236, 72, 153, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .text-gradient {
            background: linear-gradient(135deg, #db1fb3, #be23cc, #1052cc);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .heart-beat {
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            25% {
                transform: scale(1.1);
            }

            50% {
                transform: scale(1);
            }

            75% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .emoji {
            font-size: 3rem;
            margin-bottom: 20px;
            display: inline-block;
        }

        .reason-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: visible;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            /* animation: cardPulse 6s ease-in-out infinite; */
        }

        .floating-heart {
            position: absolute;
            bottom: -10px;
            font-size: 14px;
            opacity: 0.7;
            animation: floatUp 7s linear infinite;
            filter: drop-shadow(0 0 6px rgba(255,105,180,0.6));
        }

        @keyframes floatUp {
             0% {
                transform: translateY(0) scale(0.8);
                opacity: 0.7;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-140px) scale(1.3);
                opacity: 0;
            }
        }
        .floating-heart:nth-child(1) { left: 15%; animation-delay: 0s; }
        .floating-heart:nth-child(2) { left: 50%; animation-delay: 2s; }
        .floating-heart:nth-child(3) { left: 80%; animation-delay: 4s; }

        .reason-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            /* transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(255, 105, 180, 0.25); */
        }

        /* --- Title Shimmer Effect --- */
        .shimmer-title {
        display: inline-block;
        font-weight: bold;
        position: relative;

        background: linear-gradient(
            90deg,
            #ff2d95 0%,
            #ff85c1 25%,
            #ffffff 50%,
            #ff85c1 75%,
            #ff2d95 100%
        );
        background-size: 300% auto;

        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;

        animation: shimmerMove 6s ease-in-out infinite;
        overflow: visible;   /* IMPORTANT for sparkle*/
    }

    .magic-sparkle {
        position: absolute;
        font-size: 14px;
        pointer-events: none;
        z-index: 5;
        animation: sparkleAnim 2.5s ease-out forwards;
    }

    @keyframes sparkleAnim {
        0% {
            transform: scale(0.3) rotate(0deg);
            opacity: 0;
        }
        40% {
            opacity: 1;
        }
        100% {
            transform: scale(1.5) rotate(90deg);
            opacity: 0;
        }
    }

    /* Soft glowing aura around letters */
    .shimmer-title::after {
        content: attr(data-text);
        position: absolute;
        left: 0;
        top: 0;
        z-index: -1;

        background: linear-gradient(
            90deg,
            #ff2d95,
            #ff85c1,
            #ffffff,
            #ff85c1,
            #ff2d95
        );
        background-size: 300% auto;

        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;

        filter: blur(8px);
        opacity: 0.6;

        animation: shimmerMove 6s ease-in-out infinite;
    }

    @keyframes shimmerMove {
        0% { background-position: 0% center; }
        50% { background-position: 150% center; }
        100% { background-position: 300% center; }
    }

    /* Tiny sparkle dots */
.sparkle {
    position: absolute;
    font-size: 10px;
    opacity: 0;
    animation: twinkle 4s ease-in-out infinite;
}

@keyframes twinkle {
    0%, 100% { opacity: 0; transform: scale(0.5); }
    50% { opacity: 1; transform: scale(1.2); }
}


        /* --- Soft card pulse --- */
        /* @keyframes cardPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        } */

        #progress-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 400px;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            z-index: 100;
        }

        #progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ec4899, #f43f5e);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #mute-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #c934c9, #f07f92);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 18px;
            font-size: 14px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(236, 72, 153, 0.3);
            z-index: 200; 
        }
        
    </style>
</head>

<body>
    <div id="app">
        <div id="canvas-container"></div>

        <div id="progress-container">
            <div id="progress-bar"></div>
        </div>

        <button id="mute-btn">üîä Mute</button>
        <div id="content">
            <!-- Step 1: Initial Reveal -->
            <div class="step active" id="step1">
                <div class="emoji heart-beat">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                <h1 class="text-4xl md:text-5xl font-bold mb-6 text-gradient">Hi Sleeping Beauty</h1>
                <p class="text-xl text-gray-700 mb-8" style="text-align:center;">I made something special for you...</p>
                <button class="btn" id="start-btn">Let's Begin</button>
                <audio id="bgMusic" autoplay loop>
                    <source src="Jamrud-Selamat_Ulang_Tahun_(mp3.pm).mp3" type="audio/mpeg">
                    <source src="Jamrud-Selamat_Ulang_Tahun_(mp3.pm).wav">
                </audio>
            </div>

            <!-- Step 2: Birthday Message -->
            <div class="step" id="step2">
                <div class="step-scrollable">
                    <div class="emoji">üéâ</div>
                    <h2 class="text-3xl md:text-4xl font-bold mb-6 text-gradient">Happy Birthday Xenna!</h2>
                    <div class="bg-gradient-to-r from-pink-200 to-rose-200 rounded-xl flex flex-col justify-center items-center">
                        <img src="Purple Bunny Cake.jpg" height="200" width="200" alt="" srcset="">
                    </div>
                    <p class="text-lg text-gray-700 mb-6">
                        On this day that brought you into the world, <br>
                        I can‚Äôt help but feel grateful because somehow, it also brought you into my life.<br>
                        On your special day, I just want you to know how truly extraordinary you are.
                    </p>
                    <button class="btn" id="next-btn-2">What makes you special?</button>
                </div>
            </div>

            <!-- Step 3: Reasons You're Amazing -->
            <div class="step" id="step3">
                <h2 class="text-3xl md:text-4xl font-bold mb-8 text-gradient">Here's why you're incredible</h2>
                <div class="step-scrollable">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                        <div class="reason-card" style="background: linear-gradient(145deg, #ffe6f0, #fff0ff);">
                            <div class="emoji text-3xl">‚ú®</div>
                            <h3 class="text-xl font-bold mb-2 shimmer-title" data-text="Your Kindness">Your Kindness</h3>
                            <p class="text-gray-700">The way you care about others is truly inspiring. 
                                Even when you get a little upset or moody sometimes,üíñYour heart is just too big for it to stay mad for long 
                                and that‚Äôs one of the sweetest things about you.</p>
                            <span class="floating-heart">üíó</span>
                            <span class="floating-heart">üíñ</span>
                            <span class="floating-heart">ü§ç</span>
                        </div>
                        <div class="reason-card" style="background: linear-gradient(145deg, #fff0f5, #ffe6ff);">
                            <div class="emoji text-3xl">üå∏</div>
                            <h3 class="text-xl font-bold mb-2 shimmer-title" data-text="Your Gentle soul">Your Gentle soul</h3>
                            <p class="text-gray-700">There is something so quietly beautiful about the way you exist. 
                                        Your gentle soul carries a softness that comforts me. 
                                        The gentleness in your words and actions lights up every corner of my heart and stays in my mind all day.</p>
                            <span class="floating-heart">üíó</span>
                            <span class="floating-heart">üíñ</span>
                            <span class="floating-heart">ü§ç</span>
                        </div>
                        <div class="reason-card" style="background: linear-gradient(145deg, #ffe6fa, #fdf0ff);">
                            <div class="emoji text-3xl">üß†</div>
                            <h3 class="text-xl font-bold mb-2 shimmer-title" data-text="Your Beautiful Mind">Your Beautiful Mind</h3>
                            <p class="text-gray-700">I want you to know how deeply beautiful you are, not just in the way you look, but in the way you exist.
                                You see things with depth, you understand with kindness, and you speak with meaning.
                                The more I listen to you, the more I admire you, not just for how sweet you are, 
                                but for how incredibly smart and insightful you are.
                            </p>
                            <span class="floating-heart">üíó</span>
                            <span class="floating-heart">üíñ</span>
                            <span class="floating-heart">ü§ç</span>
                        </div>
                    </div>
                    <button class="btn" id="next-btn-3">A Little Surprise</button>
                </div>
            </div>

            <!-- Step 4: Memory Lane -->
            <div class="step" id="step4">
                <div class="step-scrollable">
                    <div class="emoji">üì∏</div>
                    <h2 class="text-3xl md:text-4xl font-bold mb-6 text-gradient">Our Story(So Far)...</h2>
                    <div class="bg-gradient-to-r from-pink-200 to-rose-200 rounded-xl flex flex-col justify-center items-center">
                        <img src="teddy.webp" height="200" width="200" alt="" srcset="">
                    </div>
                    <p class="text-lg text-gray-700 mb-6">
                        You‚Äôre gentle, but strong. Funny, but thoughtful. And even through a screen, you‚Äôve become someone I look forward to every single day.<br>
                        We‚Äôve built something real through simple words, somehow you‚Äôve found a place in my everyday life and become one of my favorite parts of my day.<br>
                        Through Every good morning text.<br>
                        Through those late-night talks that start silly and end a little deeper than we planned.<br>
                        Remember the night we both fell asleep because we didn‚Äôt want to stop talking?<br>
                        Remember the night we stayed up talking longer than we planned?<br>
                        Every late-night talk that was only supposed to be five minutes‚Ä¶ but turned into hours until 2AM, <br>
                        when we finally gave in and slept not because we wanted to, but because we had to.<br>
                        It‚Äôs strange how distance exists‚Ä¶ yet you still feel close.<br>
                        we have moments, feelings, and memories built through words.<br><br>
                        
                        Every moment with you turns into something I quietly treasure. Whether we‚Äôre laughing or you‚Äôre a little upset with me, <br>
                        being with you always feels meaningful. Even your smallest expressions and the way you react make me want to hold you close and sometimes, <br>
                        just sometimes, give you the tiniest playful bite because you‚Äôre that adorable.
                    </p>
                    <button class="btn" id="next-btn-4">One Last Thing</button>
                </div>
            </div>

            <!-- Step 5: Final Wish -->
            <div class="step" id="step5">
                <div class="step-scrollable">
                    <div class="emoji">üéÇ</div>
                    <h2 class="text-3xl md:text-4xl font-bold mb-6 text-gradient">My Birthday Wish For You</h2>
                    <p class="text-lg text-gray-700 mb-8">
                        On your special day, I don‚Äôt just wish you happiness for today.<br>
                        I wish you a beautiful year ahead filled with growth, peace, and exciting new beginnings.<br><br>

                        May your career move forward with confidence and success.<br>
                        May every dream you carry in your heart slowly turn into reality.<br>
                        May your hard work be rewarded, and may doors open exactly when you need them to.<br><br>

                        I wish you good health a strong body, a calm mind, and a heart that always feels safe and loved.<br><br>

                        May you stay strong in every challenge,<br>
                        gentle in every victory,<br>
                        and never forget how capable and amazing you truly are.<br><br>

                        And may your family always be surrounded with warmth, protection, and happiness<br>
                        because the people who raised someone as wonderful as you deserve endless blessings too.<br><br>

                        Most of all‚Ä¶<br>
                        I hope this year brings you closer to everything you‚Äôve been quietly hoping for.<br><br>

                        I‚Äôll always be cheering for you.
                    </p>
                    <p class="text-xl font-semibold text-pink-600 mb-8" style="text-align:center;">
                        Happy Birthday, Xenna! ‚ù§Ô∏è
                    </p>
                    <button class="btn" id="confetti-btn">Celebrate!</button>
                    <p class="mt-8 text-gray-500" style="text-align:center;">Made with ‚ù§Ô∏è just for you</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // mute unmute button
        const bgMusic = document.getElementById("bgMusic");
        const muteBtn = document.getElementById("mute-btn");

        if (bgMusic && muteBtn) {
            muteBtn.addEventListener("click", function () {
                bgMusic.muted = !bgMusic.muted;
                muteBtn.textContent = bgMusic.muted ? "üîá Unmute" : "üîä Mute";
            });
}

        // Three.js Heart + Petal Background
        // ==========================
        const container = document.getElementById('canvas-container');
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(
            75,
            window.innerWidth / window.innerHeight,
            0.1,
            1000
        );
        camera.position.z = 30;

        // ---------- Heart Shape ----------
        const x = 0, y = 0;
        const heartShape = new THREE.Shape();
        heartShape.moveTo(x + 0.5, y + 0.5);
        heartShape.bezierCurveTo(x + 0.5, y + 0.5, x + 1, y, x, y);
        heartShape.bezierCurveTo(x - 1, y, x - 1, y + 1.5, x - 1, y + 1.5);
        heartShape.bezierCurveTo(x - 1, y + 2.5, x + 0.5, y + 3.5, x + 0.5, y + 3.5);
        heartShape.bezierCurveTo(x + 0.5, y + 3.5, x + 2, y + 2.5, x + 2, y + 1.5);
        heartShape.bezierCurveTo(x + 2, y + 1.5, x + 2, y, x + 1, y);
        heartShape.bezierCurveTo(x + 0.5, y, x + 0.5, y + 0.5, x + 0.5, y + 0.5);

        const extrudeSettingsHeart = {
            depth: 0.5,
            bevelEnabled: true,
            bevelSegments: 3,
            bevelSize: 0.2,
            bevelThickness: 0.3
        };

        const heartGeometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettingsHeart);

        // ---------- Create Hearts and Petals ----------
        const hearts = [];
        const colors = [
            0xff6b6b, 0xff8e8e, 0xffb3b3, 0xffd8d8,
            0xff9e9e, 0xffc1c1, 0xff6b8e, 0xff8eb3
        ];

        // 25 hearts
        for (let i = 0; i < 25; i++) {
            const material = new THREE.MeshPhongMaterial({
                color: colors[Math.floor(Math.random() * colors.length)],
                emissive: 0xff0000,
                emissiveIntensity: 0.1,
                shininess: 100,
                transparent: true,
                opacity: 0.9
            });

            const heart = new THREE.Mesh(heartGeometry, material);

            heart.position.x = (Math.random() - 0.5) * 50;
            heart.position.y = (Math.random() - 0.5) * 50;
            heart.position.z = (Math.random() - 0.5) * 50;

            const scale = Math.random() * 0.8 + 0.5;
            heart.scale.set(scale, scale, scale);

            heart.rotation.x = Math.random() * Math.PI;
            heart.rotation.y = Math.random() * Math.PI;

            heart.userData = {
                type : "heart",
                baseScale: scale,
                pulseOffset: Math.random() * Math.PI * 2,
                speedX: Math.random() * 0.02 - 0.01,
                speedY: Math.random() * 0.02 - 0.01,
                speedZ: Math.random() * 0.02 - 0.01,
                rotationSpeedX: Math.random() * 0.01,
                rotationSpeedY: Math.random() * 0.01,
                originalX: heart.position.x,
                originalY: heart.position.y,
                originalZ: heart.position.z,
                floatDistance: 2 + Math.random() * 3
            };

            scene.add(heart);
            hearts.push(heart);
        }

        // 3 realistic rose petals (soft purple)
        for (let i = 0; i < 10; i++) {
            const petalShape = new THREE.Shape();
            petalShape.moveTo(0, 0); // bottom center of petal
            petalShape.bezierCurveTo(0.5, 0.5, 0.7, 1.5, 0, 2);  // right side curve
            petalShape.bezierCurveTo(-0.7, 1.5, -0.5, 0.5, 0, 0); // left side curve, back to base

            const extrudeSettingsPetal = {
                depth: 0.10,
                bevelEnabled: true,
                bevelSegments: 2,
                bevelSize: 0.05,
                bevelThickness: 0.05
            };

            const petalGeometry = new THREE.ExtrudeGeometry(petalShape, extrudeSettingsPetal);

            const petalMaterial = new THREE.MeshPhongMaterial({
                color: 0xC8A2C8, // soft purple
                emissive: 0x5e2b97,
                emissiveIntensity: 0.3,
                shininess: 80,
                transparent: true,
                opacity: 0.85
            });

            const petal = new THREE.Mesh(petalGeometry, petalMaterial);

            petal.position.x = (Math.random() - 0.5) * 20;
            petal.position.y = (Math.random() - 0.5) * 20;
            petal.position.z = (Math.random() - 0.5) * 20;

            const scale = Math.random() * 0.4 + 0.4; // smaller than hearts
            petal.scale.set(scale, scale, scale);

            petal.rotation.x = Math.random() * Math.PI;
            petal.rotation.y = Math.random() * Math.PI;
            // petal.rotation.z = Math.random() * Math.PI;

            petal.userData = {
                type: "petal",
                speedX: Math.random() * 0.02 - 0.01,
                speedY: Math.random() * 0.02 - 0.01,
                speedZ: Math.random() * 0.02 - 0.01,
                rotationSpeedX: Math.random() * 0.01,
                rotationSpeedY: Math.random() * 0.01,
                rotationSpeedZ: Math.random() * 0.01,
                originalX: petal.position.x,
                originalY: petal.position.y,
                originalZ: petal.position.z,
                floatDistance: 1.5 + Math.random() * 2
            };

            scene.add(petal);
            hearts.push(petal); // animate together
        }



        // ---------- Lights ----------
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(1, 1, 1);
        scene.add(directionalLight);

        // ---------- Animation Loop ----------
        function animate() {
            // requestAnimationFrame(animate);

            // const time = Date.now() * 0.001;

            // hearts.forEach(heart => {
            //     heart.position.x = heart.userData.originalX + Math.sin(time * heart.userData.speedX * 10) * heart.userData.floatDistance;
            //     heart.position.y = heart.userData.originalY + Math.sin(time * heart.userData.speedY * 10) * heart.userData.floatDistance;
            //     heart.position.z = heart.userData.originalZ + Math.sin(time * heart.userData.speedZ * 10) * heart.userData.floatDistance;

            //     heart.rotation.x += heart.userData.rotationSpeedX;
            //     heart.rotation.y += heart.userData.rotationSpeedY;
            // });

            
            // renderer.render(scene, camera);

            requestAnimationFrame(animate);

    const time = Date.now() * 0.002;

    hearts.forEach(obj => {

        if (obj.userData.type === "heart") {

            // Gentle floating
            obj.position.x += obj.userData.speedX;
            obj.position.y += Math.sin(time + obj.position.x) * 0.02;

            // Slow rotation
            obj.rotation.x += obj.userData.rotationSpeedX;
            obj.rotation.y += obj.userData.rotationSpeedY;

            // üíñ Pulse
            const pulse = 1 + Math.sin(time + obj.userData.pulseOffset) * 0.1;
            obj.scale.set(
                obj.userData.baseScale * pulse,
                obj.userData.baseScale * pulse,
                obj.userData.baseScale * pulse
            );

        } else if (obj.userData.type === "petal") {

            // üå∏ Falling effect
            obj.position.y -= obj.userData.fallSpeed;
            obj.position.x += obj.userData.drift;

            obj.rotation.z += obj.userData.rotationSpeed;

            // Reset when out of screen
            if (obj.position.y < -30) {
                obj.position.y = 30;
                obj.position.x = (Math.random() - 0.5) * 40;
            }
        }

    });

    renderer.render(scene, camera);
        }

        animate();

        // ---------- Handle Resize ----------
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });


        // Step Navigation
        let currentStep = 1;
        const totalSteps = 5;

        function updateProgressBar() {
            const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function showStep(stepNumber) {
            // Hide all steps
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });

            // Show current step
            document.getElementById(`step${stepNumber}`).classList.add('active');

            // Update progress bar
            updateProgressBar();

            // Special effect for last step
            if (stepNumber === totalSteps) {
                document.getElementById('confetti-btn').classList.add('animate-pulse');
            }
        }

        // Button event listeners
        document.getElementById('start-btn').addEventListener('click', () => {
            currentStep = 2;
            document.getElementById("bgMusic").play();
            showStep(currentStep);
        });

        document.getElementById('next-btn-2').addEventListener('click', () => {
            currentStep = 3;
            showStep(currentStep);
        });

        document.getElementById('next-btn-3').addEventListener('click', () => {
            currentStep = 4;
            showStep(currentStep);
        });

        document.getElementById('next-btn-4').addEventListener('click', () => {
            currentStep = 5;
            showStep(currentStep);
        });

        // Confetti button
        document.getElementById('confetti-btn').addEventListener('click', () => {
            // Standard confetti
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#ff0000', '#ff69b4', '#ff1493', '#ffc0cb']
            });

            // Heart-shaped confetti
            setTimeout(() => {
                confetti({
                    particleCount: 30,
                    spread: 60,
                    origin: { y: 0.5 },
                    shapes: ['heart'],
                    colors: ['#ff0000', '#ff69b4']
                });
            }, 300);

            // More hearts from different directions
            setTimeout(() => {
                confetti({
                    particleCount: 20,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    shapes: ['heart'],
                    colors: ['#ff0000', '#ff69b4']
                });

                confetti({
                    particleCount: 20,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    shapes: ['heart'],
                    colors: ['#ff0000', '#ff69b4']
                });
            }, 600);

            // Make hearts float up from the background
            hearts.forEach(heart => {
                gsap.to(heart.position, {
                    y: heart.position.y - 30,
                    duration: 3,
                    ease: "power1.out"
                });

                gsap.to(heart.material, {
                    opacity: 0,
                    duration: 3,
                    ease: "power1.out"
                });
            });
        });

        // Initialize progress bar
        updateProgressBar();


    //     document.addEventListener("DOMContentLoaded", function () {

    //     function createSparkle(titleElement) {
    //         const sparkle = document.createElement("span");
    //         sparkle.className = "magic-sparkle";
    //         sparkle.textContent = "‚ú®";

    //         const x = Math.random() * titleElement.offsetWidth;
    //         const y = Math.random() * titleElement.offsetHeight;

    //         sparkle.style.left = x + "px";
    //         sparkle.style.top = y + "px";

    //         titleElement.appendChild(sparkle);

    //         setTimeout(() => {
    //             sparkle.remove();
    //         }, 2000);
    //     }

    //     const shimmerTitles = document.querySelectorAll(".shimmer-title");

    //     shimmerTitles.forEach(title => {
    //         setInterval(() => {
    //             createSparkle(title);
    //         }, 2000);
    //     });

    // });

    window.addEventListener("load", function () {

    function createSparkle(titleElement) {
        const sparkle = document.createElement("span");
        sparkle.textContent = "‚ú®";

        sparkle.style.position = "absolute";
        sparkle.style.fontSize = "18px";
        sparkle.style.pointerEvents = "none";
        sparkle.style.zIndex = "9999";
        sparkle.style.color = "#ffffff";
        sparkle.style.textShadow = "0 0 10px #ff69b4, 0 0 20px #ff69b4";

        sparkle.style.left = Math.random() * titleElement.offsetWidth + "px";
        sparkle.style.top = Math.random() * titleElement.offsetHeight + "px";

        titleElement.appendChild(sparkle);

        sparkle.animate([
            { transform: "scale(0.5)", opacity: 0 },
            { transform: "scale(1.2)", opacity: 1 },
            { transform: "scale(1.6)", opacity: 0 }
        ], {
            duration: 1800,
            easing: "ease-out"
        });

        setTimeout(() => sparkle.remove(), 1800);
    }

    const titles = document.querySelectorAll(".shimmer-title");

    titles.forEach(title => {
        title.style.position = "relative";
        title.style.overflow = "visible";  // VERY IMPORTANT

        setInterval(() => {
            createSparkle(title);
        }, 1500);
    });

});
    </script>
</body>

</html>
